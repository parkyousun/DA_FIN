```{r}
gu<- read.csv("gu_data_3.csv")

# 기본모델
og.model<- lm(평당가격 ~ 해당.지역.지하철.지점수 + 유흥업소수 + 보건기관수 + 
    보유도서합계 + 도서관.방문자수 + 여권발급합계, data = gu)

train.og<- gu[1:16, c(4,6,8,9,11,12,13)]
test.og<-gu[17:24, c(4,6,8,9,11,12,13)]
test.og.y<- price[17:24] # 테스트셋

og.pred<- predict(og.model, newdata = train.og)

sqrt(mean((og.pred - test.og.y)^2))

```

```{r}
rownames(gu)<- gu$지역
price<- gu$평당가격

apt_pca<- log(gu[,c(4,6,8,11,12,13)])
a<-scale(apt_pca, center = T, scale = F)

cor(apt_pca)

pca.out<-prcomp(apt_pca, scale. = T)
pca.out

biplot(pca.out) # 그래프로 축과 데이터 확인
summary(pca.out) # 값으로 확인
screeplot(pca.out, type = "l") # 
```


```{r}
# 주성분 분석 결과에 따른 모형
prc <- as.matrix(apt_pca) %*% pca.out$rotation
bind.price<- cbind(price, as.data.frame(prc))

train.prc<- bind.price[1:16,]
test.prc<- bind.price[17:24,]
test.prc.y<- price[17:24] # 테스트셋

prc.model <- lm(price~PC1+PC2+PC3+PC4+PC5, data = train.prc) # 회귀분석

pcr.pred<- predict(prc.model, newdata = test.prc)



# rmse
sqrt(mean((pcr.pred - test.prc.y)^2))
```



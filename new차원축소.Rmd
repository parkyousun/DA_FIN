```{r}
apt<- read.csv("gu_data_3.csv")

rownames(apt)<- apt$지역
price<- apt$평당가격

apt_pca<- log(apt[,c(-1,-2,-9)])
#평당가격 ~ 해당.지역.지하철.지점수 + 유흥업소수 + 보건기관수 + 보유도서합계 + 도서관.방문자수 + 여권발급합계
#4,6,8,11,12,13
a<-scale(apt_pca, center = T, scale = F)

cor(apt_pca)

pca.out<-prcomp(apt_pca, scale. = T)
pca.out

biplot(pca.out) # 그래프로 축과 데이터 확인
summary(pca.out) # 값으로 확인
screeplot(pca.out, type = "l") # 
```

```{r}
prc <- as.matrix(apt_pca) %*% pca.out$rotation
train1<- cbind(price, as.data.frame(prc))
str(train1)

prc.model <- lm(price~PC1+PC2+PC3+PC4+PC5, data = train1) # 회귀분석

summary(prc.model) #모델 평가
```
